<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>지도뿌셔 - 대한민국, 어디까지 가봤니?</title>
        <link rel="stylesheet" href="src/css/index.css" />
    </head>
    <body>
        <div class="header-container">
            <img src="src/images/back.png" class="back" onclick="window.history.back()" alt=""/>
            <span onclick="goMenu('mapName.html')">지도뿌셔</span>
            <div class="empty"></div>
        </div>
        <div class="menu-container">
            <span class="title">설정</span>
            <div class="menu-box">
                백업 및 복구
            </div>
            <div class="menu-box">
                <ul>
                    <li>의견 보내기</li>
                    <li class="b-border"></li>
                    <li>후기 남기기</li>
                    <li class="b-border"></li>
                    <li>앱 추천하기</li>
                    <li class="b-border"></li>
                    <li>v0.0.1</li>
                </ul>
            </div>
            <div class="menu-box" onclick="deleteMapInfo()">
                데이터 초기화
            </div>
            <div class="menu-box" id="storageUsage"></div>
            <span class="dev-title">개발자 어플 더보기</span>
            <div class="menu-box">
                <ul>
                    <li>뽀모도로</li>
                    <li class="b-border"></li>
                    <li>조상님 로또</li>
                    <li class="b-border"></li>
                    <li>방귀어플</li>
                    <li class="b-border"></li>
                    <li>오늘은 뭐먹지?</li>
                </ul>
            </div>
        </div>
        <script src="src/js/index.js"></script>
    </body>
</html>
<script>
    document.addEventListener('DOMContentLoaded', async function() {

        const usageStorage = document.getElementById('storageUsage');

        const ul = document.createElement('ul');

        if ('storage' in navigator && 'estimate' in navigator.storage) {
            navigator.storage.estimate().then(estimate => {
                const quota = estimate.quota;// 할당된 총 용량 (바이트 단위)
                const usage = estimate.usage;// 현재 사용 중인 용량 (바이트 단위)

                const li1 = document.createElement('li');
                li1.innerHTML = `총 용량: ${(quota / (1024 * 1024)).toFixed(2)} MB`;
                ul.appendChild(li1);
                const li11 = document.createElement('li');
                li11.className = 'b-border'
                ul.appendChild(li11);
                const li2 = document.createElement('li');
                li2.innerHTML = `사용 중인 용량: ${(usage / (1024 * 1024)).toFixed(2)} MB`;
                ul.appendChild(li2);
                const li3 = document.createElement('li');
                li3.innerHTML = `남은 용량: ${((quota - usage) / (1024 * 1024)).toFixed(2)} MB`;
                ul.appendChild(li3);
            });
        } else {

            const li = document.createElement('li');
            li.innerHTML = 'StorageManager API가 지원되지 않습니다.';
            ul.appendChild(li);
        }

        usageStorage.appendChild(ul);
    });
</script>
